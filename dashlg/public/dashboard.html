<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Realtime Line Output Monitoring</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
  <style>
    * { box-sizing: border-box; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="display: flex; flex-direction: column; height: 100vh; margin: 0; overflow: hidden;">
  <header style="flex: 0 0 auto; position: relative; display: flex; justify-content: space-between; align-items: center;">
    <h1>Realtime Line Output Monitoring</h1>
    <div id="clock" class="datetime" style="position: absolute; left: 50%; transform: translateX(-50%); white-space: nowrap;"></div>
    <nav>
      <button id="logoutBtn" class="navlink" title="Logout" style="display:inline-flex;align-items:center;gap:.25rem;">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <path d="M16 17l5-5-5-5"/>
          <path d="M21 12H9"/>
        </svg>
      </button>
    </nav>
  </header>

  <main style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 1rem; width: 100%; max-width: 100%;">
    <div class="toolbar-card" style="flex: 0 0 auto; margin-bottom: 0.5rem; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; padding: 1rem 1.5rem;">
      
      <div style="display: flex; gap: 1.5rem; align-items: center;">
        <div class="field">
          <span id="currentLineLabel" style="font-size: 1.5rem; font-weight: 700; color: #111827;">Semua</span>
        </div>

        <div style="width: 1px; height: 32px; background-color: #e5e7eb;"></div>

        <div class="field" id="styleField">
          <div id="styleContainer">
            <select id="styleFilter" class="form-select" style="padding: 0.25rem 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 1.125rem;"></select>
            <div id="currentStyleLabel" style="font-size: 1.5rem; font-weight: 700; color: #111827; display: none;">-</div>
          </div>
        </div>
      </div>

      <div style="display: flex; gap: 1.5rem; align-items: center;">
        <div style="width: 1px; height: 32px; background-color: #e5e7eb; margin-right: 0.5rem;"></div>

        <div style="text-align: center;">
          <div style="font-size: 0.875rem; color: #6b7280;">Output Harian</div>
          <div id="summaryOutputHarian" style="font-size: 1.5rem; font-weight: 700; color: #10b981;">0</div>
        </div>

        <div style="width: 1px; height: 32px; background-color: #e5e7eb;"></div>

        <div style="text-align: center;">
          <div style="font-size: 0.875rem; color: #6b7280;">Output Akumulasi</div>
          <div id="summaryOutputAkumulasi" style="font-size: 1.5rem; font-weight: 700; color: #10b981;">0</div>
        </div>




      </div>

    </div>
    <div id="noOrderNotice" style="display:none; background:#fff3cd; color:#664d03; border:1px solid #ffecb5; border-radius:8px; padding:12px 16px; margin-bottom: 0.5rem;">
      Line belum ada order aktif. Silakan buat order di halaman admin.
    </div>
    <div id="rejectWarning" style="display:none; background:#fee2e2; color:#991b1b; border:1px solid #fecaca; border-radius:8px; padding:12px 16px; margin-bottom: 0.5rem; font-weight: 600; animation: pulse 2s infinite;">
      Peringatan: Reject melebihi batas toleransi 1%!
    </div>
    <style>
      @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.7; }
        100% { opacity: 1; }
      }
    </style>
    
    <!-- Flex container for charts vertical stack -->
    <div style="flex: 1; display: flex; flex-direction: column; gap: 1rem; min-height: 0; overflow-y: auto; padding-right: 5px;">
      <section class="panel active" style="display: flex; flex-direction: column; margin-bottom: 0; flex: 0 0 auto;">
        <div class="panel-header" style="padding: 0.5rem 1rem;">Output Harian</div>
        <div style="min-height: 45vh; position: relative; width: 100%;">
          <canvas id="chartTx"></canvas>
        </div>
      </section>

      <section class="panel active" style="display: flex; flex-direction: column; margin-bottom: 0; flex: 0 0 auto;">
        <div class="panel-header" style="padding: 0.5rem 1rem;">Output Akumulasi</div>
        <div style="min-height: 45vh; position: relative; width: 100%;">
          <canvas id="chartDaily"></canvas>
        </div>
      </section>
    </div>
  </main>

  <script type="module" src="/iot_dashboard.js?v=10"></script>
</body>
</html>
